"use strict";
/*!
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const assert = require("assert");
const make_http_request_1 = require("../../../src/middleware/express/make-http-request");
describe('middleware/express/make-http-request', () => {
    it('should convert latency to proto Duration', () => {
        const fakeRequest = { headers: {} };
        const fakeResponse = {};
        const h1 = make_http_request_1.makeHttpRequestData(fakeRequest, fakeResponse, 1003);
        assert.deepStrictEqual(h1.latency, { seconds: 1, nanos: 3e6 });
        const h2 = make_http_request_1.makeHttpRequestData(fakeRequest, fakeResponse, 9003.1);
        assert.deepStrictEqual(h2.latency, { seconds: 9, nanos: 3.1e6 });
        // Make sure we nanos is uint32.
        const h3 = make_http_request_1.makeHttpRequestData(fakeRequest, fakeResponse, 1.0000000001);
        assert.deepStrictEqual(h3.latency, { seconds: 0, nanos: 1e6 });
    });
});
//# sourceMappingURL=test-make-http-request.js.map